
<div class="bg-white rounded-lg overflow-hidden shadow-md w-100">
  <div class=" overflow-y-auto" id="chat-messages" style="height: 75vh;">

      <div class="col-sm-3 col-xs-12">
        <div class="col-inside-lg decor-default chat" style="overflow: hidden; outline: none;" tabindex="5000">
          <div class="chat-users">
            
              <div class="user">
                  <div class="avatar">
                  <img src="https://bootdey.com/img/Content/avatar/avatar1.png" alt="User name">
                  <div class="status online"></div>
                  <%# off online %>
                  </div>
                  <div class="name">Food Bot</div>
                  <div class="mood">Active</div>
              </div>
            <hr class="border-t border-gray-300 shadow-md">
          </div>
        </div>
      </div>

      

      <div class="col-sm-9 col-xs-12 chat" style="overflow: hidden; outline: none;" tabindex="5001">
        <div class="col-inside-lg decor-default">

          <div class="chat-body">
            <div class="answer left">
              <div class="avatar">
                <img src="https://bootdey.com/img/Content/avatar/avatar1.png" alt="Bot">
                <div class="status online"></div>
              </div>
              <div class="name">Bot</div>
              <div class="text">
                Hello, How can I help you?
              </div>
              <div class="time">5 min ago</div>
            </div>
          </div>


        </div>
      </div>
  </div>
</div>

<div class=" relative my-[-10px] px-20 flex p-4 bg-gray-200">
  <input type="text" id="message-input" placeholder="Type your message..." class="flex-1 py-2 px-4 border rounded-l-lg">
  <button onclick="sendMessage()" class="bg-gray-700 text-white py-2 px-4 rounded-r-lg">Send</button>
</div>

<script>
  function sendMessage() {
    var userInput = document.getElementById('message-input').value;
    var chatBody = document.querySelector('.chat-body');
    var chatMessages = document.getElementById('chat-messages');

    // Clear the input field
    document.getElementById('message-input').value = '';

    // Display user message
    displayMessage(userInput, 'right', 'https://bootdey.com/img/Content/avatar/avatar2.png', 'User', 'online');

    // Send user message to the server
    fetch('/viber_webhook/receive', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({ message: userInput }),
    })
    .then(response => response.json())
    .then(data => {
      // Display bot response
      displayMessage(data.bot_response, 'left', 'https://bootdey.com/img/Content/avatar/avatar1.png', 'Bot', 'online');
      
      // Scroll to the bottom of the chat
      chatMessages.scrollTop = chatMessages.scrollHeight;
    })
    .catch(error => console.error('Error:', error));

    function displayMessage(messageText, alignment, userImage, userName, userStatus) {
      var chatBubble = document.createElement('div');
      chatBubble.classList.add('answer', alignment);

      var avatarDiv = document.createElement('div');
      avatarDiv.classList.add('avatar');

      var img = document.createElement('img');
      img.src = userImage; // Use the provided user image URL
      img.alt = userName;

      var statusDiv = document.createElement('div');
      statusDiv.classList.add('status', userStatus);

      avatarDiv.appendChild(img);
      avatarDiv.appendChild(statusDiv);

      var nameDiv = document.createElement('div');
      nameDiv.classList.add('name');
      nameDiv.textContent = userName;

      var textDiv = document.createElement('div');
      textDiv.classList.add('text');
      textDiv.textContent = messageText;

      var timeDiv = document.createElement('div');
      timeDiv.classList.add('time');
      timeDiv.textContent = 'Just now';

      chatBubble.appendChild(avatarDiv);
      chatBubble.appendChild(nameDiv);
      chatBubble.appendChild(textDiv);
      chatBubble.appendChild(timeDiv);

      chatBody.appendChild(chatBubble);
    }

  }
</script>

